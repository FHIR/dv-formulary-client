<section class='container'>
	<% if @client %>
		<p class="text-success m-auto client-connected" style='text-align: center'>
			Connected to <%= cookies[:server_url] -%>, which houses <%= @count %> Formulary Drugs
		</p>
	<%else%>
		<p class="text-danger m-auto" style='text-align: center'>No Connection Established</p>
	<% end %>
	<h2 class="text-light welcome-text">Connect to a Formulary server</h2>
	<section class='row mb-5'>
		<%= form_tag root_path, method: 'get', class: 'form-inline welcome-form', id: 'server-form' do %>
			<div class='col'></div>
			<div class='form-group col-md-7'>
				<%= text_field_tag :server_url, nil, class: 'form-control',
							placeholder: 'https://davinci-drug-formulary-ri.logicahealth.org/fhir' %>
			</div>
			<%= button_tag 'Connect', class: 'btn btn-primary col-md-2', id: 'server-url' %>
			<div class='col'></div>
		<% end %>
	</section>
	<h2 class="text-light welcome-text">Lookup FormularyDrugs by Plan, Tier, Name and/or RxNorm</h2>
	<section class='row mb-1'>
		<%= form_tag formularies_path, method: 'get', class: 'form-inline welcome-form', id: 'formulary-form' do %>
			<div class='form-group col-md-3'>
				<%= select_tag(:coverage, options_for_select(@cp_options), 
								prompt: 'Coverage Plan', class: 'custom-select coverage-select') %>
			</div>
			<div class='form-group col-md-3'>
				<%= select_tag(:drug_tier, options_for_select([['All', ''], 
												['Generic', 'generic'],
												['Preferred Brand', 'preferred-brand'], 
												['Non-preferred Brand', 'non-preferred-brand'],
												['Specialty', 'specialty'], 
												['Non-preferred Brand Specialty', 'non-preferred-brand-specialty'],
												['Zero-cost Share Preventive', 'zero-cost-share-preventive']]),
												prompt: 'Drug Tier',
												class: 'custom-select drug-tier-select') %>
			</div>
			<div class='form-group col-md-3'>
				<%= text_field_tag :name, nil, class: 'form-control code-input', placeholder: 'Drug Name'%>
			</div>

			<div class='form-group col-md-3'>
				<%= text_field_tag :code, nil, class: 'form-control code-input', placeholder: 'RxNorm code'%>
			</div>
			<%= button_tag 'Lookup', class: 'btn btn-primary col-md-2', id: 'formulary-url', disabled: @client.nil? %>
			<div class='col'></div>
		<% end %>
	</section>
	<p class='text-light welcome-text ml-auto mr-auto mb-5'>
		Each of the above options can be left unspecified. 
		Pressing "Lookup" will display the intersection of defined options.
	</p>
	<h2 class="text-light welcome-text">Review Coverage Plans</h2>
	<section class='row mb-1'>
		<%= form_tag coverageplans_path, method: 'get', class: 'form-inline welcome-form', id: 'coverageplan-form' do %>
			<div class='col'></div>
			<div class='form-group col-md-7'>
				<%= text_field_tag :search, nil, class: 'form-control', placeholder: 'Search by CoveragePlan name' %>
			</div>
			<%= button_tag 'Review CoveragePlans', class: 'btn btn-primary col-md-3', id: 'coverageplan-url', disabled: @client.nil? %>
			<div class='col'></div>
		<% end %>
	</section>

	<h2 class="text-light welcome-text">Compare Coverage Plan Formularies</h2>
	<section class='row mb-1'>
		<%= form_tag compare_index_path, method: 'get', class: 'form-inline welcome-form', id: 'compare-form' do %>
			<div class='col'></div>
			<div class='form-group col-md-4'>
				<%= text_field_tag :search, nil, class: 'form-control', placeholder: 'Search by drug name' %>
			</div>			
			<div class='form-group col-md-4'>
				<%= text_field_tag :code, nil, class: 'form-control code-input', placeholder: 'List of RxNorm codes'%>
			</div>

			<%= button_tag 'Compare Plans', class: 'btn btn-primary col-md-3', id: 'compare-url', disabled: @client.nil? %>
			<div class='col'></div>
		<% end %>
	</section>
		<p class='text-light welcome-text ml-auto mr-auto mb-5'>
		<% if @client %>
			<% if @cache_nil %>
				May load up to <%= @count %> FormularyDrugs and <%= @cp_count %> CoveragePlans from the server. 
			<% else %>
				All <%= @count %> Formularies are cached, should load quickly.
			<% end %>
		<% else  %>
			Must first connect to a Formulary server.
		<% end %>
	</p>

